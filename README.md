# order-service
demo service displaying order data

## **[<u>Задание</u>](docs/task.md)**

## Описание

`Order Service` — демонстрационный микросервис на Go, который получает заказы из Kafka, сохраняет их в PostgreSQL, кэширует в памяти и предоставляет HTTP-интерфейс для получения информации о заказе по его ID.

Сервис реализует работу с сообщениями, базой данных, кэшем и веб-интерфейсом.

---

## Технологии

- **Go** 
- **Kafka** — брокер сообщений
- **PostgreSQL** — база данных
- **go-cache** — кэш в памяти
- **Docker + Docker Compose** — контейнеризация
- **HTML (статическая страница)** — пользовательский интерфейс

---

## Функциональность

- Подключение к Kafka и подписка на топик `order`.
- Обработка входящих JSON-сообщений с заказами.
- Валидация структуры заказа.
- Сохранение данных в PostgreSQL.
- Кэширование заказов в памяти для ускоренного доступа.
- Восстановление кэша из БД при старте.
- HTTP API:
  - `GET /order?id=<order_uid>` — получение информации о заказе.
- Веб-страница:
  - HTML-форма на `/`, позволяющая ввести `order_uid` и получить данные.

---

## Начало работы
### Установка
Клонирование репозитория
```sh
git clone https://github.com/AugustSerenity/order-service
```
### Запуск сервиса
Запускаем контейнер с помощью Makefile
```sh
make run
```
### Запуск producer
Запускаем producer с помощью Makefile, который отправляет сообщения в кафку
```sh
make run-producer
```

### Просмотр веб-интерфейса

**Основная страница:** [`http://localhost:8080/`](http://localhost:8080/)

Примеры `order_uid` для вставки в поле ID:
 - `b563feb7b2b84b6test`
 - `e7f4a92b4e1c47d8test`
 - `c456deb8c5d95e8test`

После ввода ID и нажатия кнопки `GET` вы будете автоматически перенаправлены на:
[`http://localhost:8080/order?id=<order_uid>`] 
где отобразится JSON с данными соответствующего заказа.

### Просмотр Kafka 

Для мониторинга Kafka используется `Kafka UI` — удобный веб-интерфейс.

**Открыть Kafka UI:** [`http://localhost:8081`](http://localhost:8081)

Возможности интерфейса:
- Просмотр всех топиков (в том числе `order`)
- Просмотр сообщений, полученных сервисом
- Проверка формата отправленных заказов
- Возможность отправки тестовых JSON-сообщений напрямую в топик

**Топик по умолчанию:** `order`

Для эмуляции данных можно использовать кнопку **"Produce message"** и вставить JSON заказа
или использовать `producer` для отправки заказов в кафку 
```sh
make run-producer
```

